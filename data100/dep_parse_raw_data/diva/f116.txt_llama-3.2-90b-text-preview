To analyze the Swedish sentence and produce a dependency tree, I will break down the sentence into its constituent parts and assign dependencies based on grammatical function. Here is the analysis:

1. Viruset - Subject (index 1)
2. aktiveras - Verb (index 2)
3. då - Adverb (index 3)
4. användaren - Subject (index 4)
5. kör - Verb (index 5)
6. det - Object (index 6)
7. program - Object (index 7)
8. som - Subordinating conjunction (index 8)
9. viruset - Subject (index 9)
10. infekterat - Verb (index 10)
11. . - Punctuation mark (index 11)

Here is the dependency tree as a list of triples:

[(1, Viruset, 2), 
 (2, aktiveras, 3), 
 (3, då, 5), 
 (4, användaren, 5), 
 (5, kör, 2), 
 (6, det, 7), 
 (7, program, 5), 
 (8, som, 10), 
 (9, viruset, 10), 
 (10, infekterat, 5), 
 (11, ., 2)]

In this dependency tree:

- 'Viruset' is the subject of 'aktiveras' (1, Viruset, 2).
- 'aktiveras' is the main verb, and 'då' is an adverb modifying it (2, aktiveras, 3).
- The clauses 'användaren kör' and 'viruset infekterat' are subordinated to the main clause, with 'användaren' and 'viruset' as subjects of their respective verbs 'kör' and 'infekterat'.
- 'det' is the direct object of 'kör', which is a transitive verb (6, det, 7).
- 'program' is the object of 'kör' (7, program, 5).
- The clause 'som viruset infekterat' is a subordinate clause describing 'program' (8, som, 10).
- The final punctuation mark '.' is dependent on the main verb 'aktiveras'. 

Note that dependency parsing can sometimes be subjective, and different parsers may produce different results. However, this analysis should provide a good starting point for understanding the grammatical structure of the sentence.